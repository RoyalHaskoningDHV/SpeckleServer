(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-61ebce74"],{"014b":function(e,t,r){"use strict";var s=r("18df"),a=r.n(s);a.a},"18df":function(e,t,r){},"1a47":function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("md-content",{staticClass:"speckle-alert md-accent md-elevation-2"},[r("div",{staticClass:"md-layout md-alignment-center-center"},[r("div",{staticClass:"md-layout-item md-size-80"},[e._t("default")],2),r("div",{staticClass:"md-layout-item md-size-20",staticStyle:{"text-align":"right"}},[r("md-button",{staticClass:"md-icon-button md-raised",nativeOn:{click:function(t){e.$emit("closed")}}},[r("md-icon",[e._v("close")])],1)],1)])])},a=[],o={name:"SpeckleAlert",props:{type:String}},i=o,n=(r("b330"),r("2877")),l=Object(n["a"])(i,s,a,!1,null,"18e89500",null);l.options.__file="SpeckleAlert.vue";t["a"]=l.exports},"61ee":function(e,t,r){},a55b:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("md-content",{staticClass:"md-layout md-alignment-center-center",staticStyle:{"min-height":"100%"}},[!1===e.$store.state.isAuth?r("form",{staticClass:"md-layout-item md-size-33 md-small-size-100 md-medium-size-50",on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[r("md-card",{staticClass:"md-elevation-3"},[r("md-card-header",[r("md-card-header-text",[r("div",{staticClass:"md-title"},[e._v("Login")]),r("div",{staticClass:"md-caption"},[e.$store.state.serverManifest?r("span",[e._v("at "),r("strong",[r("a",{attrs:{href:e.$store.state.server,target:"_blank"}},[e._v(e._s(e.$store.state.serverManifest.serverName))])]),e._v(".")]):e._e(),e._v("\n          Do you want to "),r("router-link",{attrs:{to:"/register"}},[e._v("register")]),e._v("?")],1)])],1),r("md-card-content",[r("md-field",[r("md-icon",[e._v(e._s(e.serverOk?"check":"chevron_right"))]),r("label",[e._v("Server API address")]),r("md-input",{attrs:{type:"url",name:"server"},on:{blur:e.checkServer},model:{value:e.server,callback:function(t){e.server=t},expression:"server"}})],1),r("md-field",[r("label",[e._v("Email adress")]),r("md-input",{attrs:{type:"email",name:"email"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),r("md-field",[r("label",[e._v("Password")]),r("md-input",{attrs:{type:"password",name:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),e.$store.state.isAuth?e._e():r("md-card-actions",[r("md-button",{staticClass:"md-primary md-raised",attrs:{type:"submit"}},[e._v("Login")])],1),r("br"),r("speckle-alert",{directives:[{name:"show",rawName:"v-show",value:e.showError,expression:"showError"}],attrs:{type:"error"},on:{closed:function(t){e.showError=!1}}},[e._v("\n        "+e._s(e.errorMessage)+"\n      ")])],1)],1):r("md-card",{staticClass:"md-elevation-3"},[r("md-card-content",[e._v("\n      You are already logged in.\n    ")])],1)],1)},a=[],o=(r("6762"),r("2fdb"),r("bc3a")),i=r.n(o),n=r("1a47"),l={name:"LoginView",components:{SpeckleAlert:n["a"]},computed:{},watch:{},data:function(){return{server:null,email:null,password:null,errorMessage:null,showError:!1,serverOk:!1}},methods:{login:function(){var e=this;this.$store.dispatch("login",{email:this.email,password:this.password}).then(function(t){if(console.log("Logged in."),e.$store.dispatch("getStreams","omit=objects,layers&isComputedResult=false&deleted=false&sort=-lastModified"),e.$store.dispatch("getProjects"),null!==e.$route.params.redirectTo&&void 0!==e.$route.params.redirectTo){var r=atob(e.$route.params.redirectTo);e.$router.push(r),e.password=null}else e.$router.push("/")}).catch(function(t){console.log(t),e.errorMessage="Failed to log in.",e.showError=!0})},checkServer:function(){var e=this;this.server.includes("api")||(this.server+="/api"),i.a.get(this.server).then(function(t){if(!t.data.hasOwnProperty("serverName"))throw new Error("Failed to get server.");e.serverOk=!0,e.errorMessage="",e.showError=!1,e.$store.commit("SET_SERVER",e.server),e.$store.commit("SET_SERVER_DETAILS",t.data),localStorage.setItem("server",e.server),i.a.defaults.baseURL=e.server}).catch(function(t){e.serverOk=!1,e.errorMessage="Server url is incorrect.",e.showError=!0})}},mounted:function(){this.$store.state.server?(this.server=this.$store.state.server,this.checkServer()):(this.server="".concat(window.location.origin,"/api"),this.checkServer()),!0===this.$store.state.isAuth&&this.$router.push("/")}},c=l,d=(r("014b"),r("2877")),m=Object(d["a"])(c,s,a,!1,null,"6a9f7f80",null);m.options.__file="Login.vue";t["default"]=m.exports},b330:function(e,t,r){"use strict";var s=r("61ee"),a=r.n(s);a.a}}]);
//# sourceMappingURL=chunk-61ebce74.b1bfa1b8.js.map